# ะะฐัััะพะนะบะฐ lvm cache ะฝะฐ nvmeะฒ ัะพะผ ัะธัะปะต ะดะปั root-ัะฐะทะดะตะปะฐ  
## ะะพะณะธะบะฐ ัะฐะฑะพัั

=>https://www.it-world24.ru/programmy/lvm-cache-prozrachnoe-keshirovanie-hdd-ispolzuya-ssd.html

* FIXME...
* ะปะพะณะธะบะฐ...

# ะะพะดะณะพัะฐะฒะปะธะฒะฐะตะผ ัะธััะตะผั

## ะกะพะฑััะฒะตะฝะฝะพ ัะพะทะดะฐัะผ lvm cache:
```
lvcreate -n root_cache_metadata -L600M vg_root /dev/nvme0n1
lvcreate -n root_cache_data -L60G vg_root /dev/nvme0n1
lvconvert --type cache-pool --cachemode writeback --poolmetadata vg_root/root_cache_metadata  vg_root/root_cache_data
lvconvert --type cache --cachepool vg_root/root_cache_data vg_root/root_deb
```


## ะฝะฐัััะฐะธะฒะฐะตะผ ะพะฟัะธะธ ัะดัะฐ:
ะฒ /etc/default/grub ะฟัะฐะฒะธะผ ะฟะฐัะฐะผะตัั ะพะฟัะธะน ัะดัะฐ:
```
GRUB_CMDLINE_LINUX="rd.md=1 rd.md.conf=1 rd.auto=1"
```

## ะะฐัััะฐะธะฒะฐะตะผ dracut:
```
apt-get isntall dracut
```
### ะะพะฑะฐะฒะปัะตะผ ะฝัะถะฝัะต ะผะพะดัะปะธ:
ะกะพะทะดะฐัะผ ัะฐะนะป ะทะฐะณััะทะบะธ ะผะพะดัะปะตะน /etc/dracut.conf.d/lvm.conf ั ัะพะดะตัะถะธะผัะผ (ะพะฑัะทะฐัะตะปัะฝะพ ะฒะพะบััะณ ะธะผะตะฝะธ ะผะพะดัะปั - ะฟัะพะฑะตะปั):
```
# support lvm root:
add_dracutmodules+=" lvm "
```
ะกะพะทะดะฐัะผ ัะฐะนะป ะทะฐะณััะทะบะธ ะผะพะดัะปะตะน /etc/dracut.conf.d/mdadm.conf ั ัะพะดะตัะถะธะผัะผ (ะพะฑัะทะฐัะตะปัะฝะพ ะฒะพะบััะณ ะธะผะตะฝะธ ะผะพะดัะปั - ะฟัะพะฑะตะปั):
```
# support mdadm root:
add_dracutmodules+=" mdraid "
```

### ะะตัะตัะพะฑะธัะฐะตะผ initramfs-ะพะฑัะฐะทั ะดะปั ะฒัะตั ัะดะตั

ะกะผะพััะธะผ ะบะฐะบะธะต ะผะพะดัะปะธ ะตััั (ะดะปั ะบะฐะบะธั ัะดะตั):
```
ls /lib/modules
```
ะะตัะตัะพะฑะธัะฐะตะผ:

```
dracut /boot/initrd.img-6.1.0-13-amd64 6.1.0-13-amd64 --force
dracut /boot/initrd.img-6.1.0-15-amd64 6.1.0-15-amd64 --force
```

## ะะฑะฝะพะฒะปัะตะผ ะฟะฐัะฐะผะตััั ะทะฐะณััะทะบะธ
ะะตัะตัะพะฑะธัะฐะตะผ ะบะพะฝัะธะณ ั ะฝะพะฒัะผะธ ะฟะฐัะฐะผะตััะฐะผะธ ัะดัะฐ, ะฟัะพะฟะธััะฒะฐะตะผ ะฝะพะฒัะต initramfs, ะฟัะพะฟะธััะฒะฐะตะผ ะทะฐะณััะทะบั ะฒ ะฑะปะพัะฝัะต ััััะพะนััะฒะฐ:
```
dpkg-reconfigure grub-pc
```

### ะัะบะปััะตะฝะธะต ะบััะฐ

```
lvconvert --uncache vg_root/root_deb
```


=>../index.gmi ๐ ะฒะตัะฝััััั ะบ ะฝะฐัะฐะปั...
